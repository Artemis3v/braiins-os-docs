################
راهنمای پیشرفته
################

.. contents::
	:local:
	:depth: 1

********
نقشه راه
********

ابزارها ، بسته ها و اسکریپت های زیادی وجود دارد که می تواند برای مدیریت Braiins OS استفاده شود. برای پیمایش بهتر ، از منوی زیر استفاده کنید:

 * نصب Braiins OS 
 
  * با استفاده از BOS Toolbox (:ref:`bosbox_install`)
  * با استفاده از بسته وب (:ref:`web_package_install`)
  * با استفاده از کارت حافظه SD (:ref:`sd_install`)
  * با استفاده از کارت حافظه SD و ابزار ماینر (:ref:`miner_nand_install`)
  * با استفاده از اسکریپت SSH (:ref:`ssh_package_install`)
  
 * بروز رسانی Braiins OS
 
  * با استفاده از BOS Toolbox (:ref:`bosbox_update`)
  * با استفاده از OPKG (:ref:`opkg_update`)
  * با استفاده از بسته sysupgrade (:ref:`sysupgrade_switch_braiinsplus`)
  * با استفاده از اسکریپت bos2bos (:ref:`bos2bos`)
  
 * تغییر دادن به Braiins OS (نسخه بدون اتوتیونینگ)
 
  * با استفاده از بسته sysupgrade (:ref:`sysupgrade_switch_braiinsos`)
  * با استفاده از اسکریپت bos2bos (:ref:`bos2bos`)
  
 * تغییر دادن به Braiins OS+ (نسخه دارای اتوتیونینگ)
 
  * با استفاده از OPKG (:ref:`opkg_switch_to_braiinsplus`)
  * با استفاده از بسته sysupgrade (:ref:`sysupgrade_switch_braiinsplus`)
  * با استفاده از اسکریپت bos2bos (:ref:`bos2bos`)
  
 * بازنصب نسخه ابتدایی Braiins OS (نسخه ابتدایی, نسخه‌ای که برای اولین بار روی دستگاه نصب شده بود) - بازنشاندن حالت کارخانه
 
  * با استفاده از OPKG (:ref:`opkg_factory_reset`)
  * با استفاده از کارت حافظه SD (:ref:`sd_factory_reset`)
  * با استفاده از ابزار "miner" (:ref:`miner_factory_reset`)
  * با استفاده از اسکریپت bos2bos (:ref:`bos2bos`)
  
 * حذف نصب Braiins OS
 
  * با استفاده از BOS Toolbox (:ref:`bosbox_uninstall`)
  * با استفاده از اسکریپت SSH (:ref:`ssh_package_uninstall`)

.. _bosbox:

******************
ابزار BOS Toolbox
******************

BOS Toolbox ابزاری جدید است که به کاربر اجازه می دهد تا به راحتی Braiins OS را نصب ، حذف ، بروزرسانی  و تنظیم کند. همچنین امکان انجام این کار در حالت دسته ای نیز فراهم شده است و این امر باعث می شود مدیریت تعداد بیشتر دستگاه ها آسان تر شود. این روش پیشنهادی برای مدیریت دستگاه های شما است.

==========
روش کاربرد
==========

  * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد. **.فقط از یک آدرس IP در هر سطر استفاده کنید!**
  * بخش های زیر را دنبال کنید

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

  + Braiins OS را از راه دور نصب می کند
  + Braiins OS را از راه دور بروزرسانی می کند
  + Braiins OS را از راه دور پاک می کند
  + Braiins OS را از راه دور تنظیم می کند
  + شبکه دستگاه ها را اسکن می کند
  + هنگام نصب Braiins OS، کل تنظیمات را بطور پیش فرض (می توان تنظیم کرد) منتقل می کند
  + هنگام حذف Braiins OS، تنظیمات شبکه را بطور پیش فرض (می توان تنظیم کرد) منتقل می کند
  + پارامترها برای سفارشی کردن فرآیند در دسترس هستند
  + حالت دسته ای برای مدیریت چندین دستگاه به طور همزمان
  + استفاده آسان
  
  - بر روی ماینری که SSH آن مسدود شده است، کار نمیکند

.. _bosbox_install:

==================================================
Braiins OS را با استفاده از BOS Toolbox نصب کنید
==================================================

  * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد قرار دهید.
  * پس از دانلود BOS Toolbox، مترجم خط فرمان خود را باز کنید (مانند CMD برای ویندوز ، Terminal برای اوبونتو و غیره) و از دستورات زیر استفاده کنید:

::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * اکنون *listOfMiners.csv* را با نام فایل خود در دستور زیر جایگزین کنید و دستور مناسب را برای سیستم عامل خود اجرا کنید:

    برای خط فرمان **Windows**: ::

      bos-toolbox.exe install ARGUMENTS HOSTNAME

    برای خط فرمان **Linux**: ::
      
      ./bos-toolbox install ARGUMENTS HOSTNAME

    **توجه** *زمانی که از BOS Toolbox برای لینوکس استفاده می‌کنید، لازم است برای قابل اجرا کردن کردن فایل از دستور زیر استفاده کنید (این برای یکبار کافی‌ است):* ::
  
      chmod u+x ./bos-toolbox

برای تنظیم فرآیند می توانید از **ARGUMENTS** زیر استفاده کنید:

**نکته مهم:** 
هنگام نصب Braiins OS در **یک دستگاه** ، از آرگومان *HOSTNAME* (آدرس IP) استفاده کنید.
هنگام نصب Braiins OS روی **چندین دستگاه** ، از HOSTNAME استفاده **نکنید**، بلکه از آرگومان *--batch BATCH* استفاده کنید.

====================================  ============================================================
آرگومان‌ها                             توضیحات
====================================  ============================================================
-h, --help                            پیغام help نشان داده شود و سپس خارج می‌شود
--batch BATCH                         مسیر به فایل دارای لیست میزبانها (آدرس های IP) برای نصب
--backup                              قبل از ارتقا از ماینر بک آپ می‌گیرد
--no-nand-backup                      بک آپ کامل حافظه NAND را رد می‌کند( تنظیمات بک‌ آپ گرفته میشوند)
--pool-user [POOL_USER]               نام کاربری و نام worker برای استخر پیش فرض تنظیم می‌کند
--no-keep-network                     تنظیمات شبکه ماینر را ذخیره نمی‌کند(از DHCP استفاده کنید)
--no-keep-pools                       تنظیمات استخر ماینر را ذخیره نمی‌کند
--no-keep-hostname                    نام میزبان ماینر را ذخیره نمی‌کند و نام جدید بر اساس MAC  بسازید
--keep-hostname                       اجبار به نگهداشتن نام میزبان
--no-wait                             نیازی نیست تا زمانی که سیستم به طور کامل ارتقا یافته صبر می‌کند.
--dry-run                             تمام مراحل ارتقا را بدون انجام واقعی ارتقا انجام می‌دهد
--post-upgrade [POST_UPGRADE]         مسیر به دایرکتوری با اسکریپت stage3.sh
--install-password INSTALL_PASSWORD   رمز عبور SSH برای نصب
====================================  ============================================================

**مثال:**

::

  ./bos-toolbox.exe install --batch listOfMiners.csv --install-password admin

این دستور Braiins OS را روی ماینرهایی نصب می کند که در فایل *listOfMiners.csv* مشخص شده اند. این فرمان همچنین به طور خودکار رمزعبور SSH را وقتی درخواست میکند *admin* وارد می کند.

.. _bosbox_update:

=================================================
بروز رسانی Braiins OS با استفاده از BOS Toolbox
=================================================

  * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد قرار دهید.
  * پس از دانلود BOS Toolbox، مترجم خط فرمان خود را باز کنید (مانند CMD برای ویندوز ، Terminal برای اوبونتو و غیره) و از دستورات زیر استفاده کنید:

::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * اکنون *listOfMiners.csv* را با نام فایل خود در دستور زیر جایگزین کنید و دستور مناسب را برای سیستم عامل خود اجرا کنید:

    برای خط فرمان **Windows**: ::

      bos-toolbox.exe update ARGUMENTS HOSTNAME

    برای خط فرمان **Linux**: ::
      
      ./bos-toolbox update ARGUMENTS HOSTNAME

    **توجه** *زمانی که از BOS Toolbox برای لینوکس استفاده می‌کنید، لازم است برای قابل اجرا کردن کردن فایل از دستور زیر استفاده کنید (این برای یکبار کافی‌ است):* ::
  
      chmod u+x ./bos-toolbox

برای تنظیم فرآیند می توانید از **ARGUMENTS** زیر استفاده کنید:

**نکته مهم:** 
هنگام نصب Braiins OS در **یک دستگاه** ، از آرگومان *HOSTNAME* (آدرس IP) استفاده کنید.
هنگام نصب Braiins OS روی **چندین دستگاه** ، از HOSTNAME استفاده **نکنید**، بلکه از آرگومان *--batch BATCH* استفاده کنید.

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
--h, --help                            پیغام help نشان داده شود و سپس خارج می‌شود
--batch BATCH                         مسیر به فایل دارای لیست میزبان‌ها برای نصب
-p PASSWORD, --password PASSWORD      رمزعبور مدیریتی
-i, --ignore                          چشم‌پوشی هنگام خطا
====================================  ============================================================


**مثال:**

::

  ./bos-toolbox.exe update --batch listOfMiners.csv

این دستور برای ماینرهایی که در *listOfMiners.csv* مشخص شده اند ،  بروزرسانی را جستجو‌میکند و در صورت وجود نسخه جدیدی از فریم‌ور، آنها را به روز می کند.

.. _bosbox_uninstall:

==============================================
حذف نصب Braiins OS با استفاده از BOS Toolbox
==============================================

  * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد قرار دهید.
  * پس از دانلود BOS Toolbox، مترجم خط فرمان خود را باز کنید (مانند CMD برای ویندوز ، Terminal برای اوبونتو و غیره) و از دستورات زیر استفاده کنید:
  * یک فایل جدید text در ویرایشگر متنی خود ایجاد کنید و آدرس‌های IP که میخواهید دستورات در آنها اجرا شود را وارد کنید. هر IP باید با کاما از هم جدا شود. (توجه کنید که میتوانید آی پی آدرس دستگاه را با مراجعه به منوی *Status - > Overview* در رابط کاربری وب پیدا کنید.) سپس فایل را در همان پوشه ای که BOS Toolbox هست ذخیره کنید و پسوند فایل را از ".txt" به ".csv" تغییر نام دهید.
  * عبارت *FILE_PATH_TO_BOS_TOOLBOX* را در دستور زیر با مسیری که فایل BOS Toolbox را ذخیره کرده‌اید تغییر دهید. سپس با دستور زیر به فایل بروید: ::

::

      cd FILE_PATH_TO_BOS_TOOLBOX

  * اکنون *listOfMiners.csv* را با نام فایل خود در دستور زیر جایگزین کنید و دستور مناسب را برای سیستم عامل خود اجرا کنید:

    برای خط فرمان **Windows**: ::

      bos-toolbox.exe uninstall ARGUMENTS HOSTNAME

    برای خط فرمان **Linux**: ::
      
      ./bos-toolbox uninstall ARGUMENTS HOSTNAME

    **توجه** *زمانی که از BOS Toolbox برای لینوکس استفاده می‌کنید، لازم است برای قابل اجرا کردن کردن فایل از دستور زیر استفاده کنید (این برای یکبار کافی‌ است):* ::
  
      chmod u+x ./bos-toolbox

برای تنظیم فرآیند می توانید از **ARGUMENTS** زیر استفاده کنید:

**نکته مهم:** 
هنگام نصب Braiins OS در **یک دستگاه** ، از آرگومان *HOSTNAME* (آدرس IP) استفاده کنید.
هنگام نصب Braiins OS روی **چندین دستگاه** ، از *HOSTNAME* استفاده **نکنید**، بلکه از آرگومان *--batch BATCH* استفاده کنید.

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
-h, --help                            پیغام help نشان داده شود و سپس خارج می‌شود
--batch BATCH                          مسیر به فایل دارای لیست میزبان‌ها
--factory-image FACTORY_IMAGE          مسیر یا آدرس path/url فایل اصلی کارخانه (پیشفرض:
                                      Antminer-S9-all-201812051512-autofreq-user-Update2UBI-
                                      NF.tar.gz)
====================================  ============================================================

**مثال:**

::

  ./bos-toolbox.exe uninstall --batch listOfMiners.csv

This command will uninstall Braiins OS from the miners, that are specified in the *listOfMiners.csv* file and install a default stock firmware (Antminer-S9-all-201812051512-autofreq-user-Update2UBI-NF.tar.gz).

.. _bosbox_configure:

===========================================
تنظیم Braiins OS با استفاده از BOS Toolbox
===========================================

  * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد قرار دهید.
  * پس از دانلود BOS Toolbox، مترجم خط فرمان خود را باز کنید (مانند CMD برای ویندوز ، Terminal برای اوبونتو و غیره) و از دستورات زیر استفاده کنید:
  * یک فایل جدید text در ویرایشگر متنی خود ایجاد کنید و آدرس‌های IP که میخواهید دستورات در آنها اجرا شود را وارد کنید. هر IP باید با کاما از هم جدا شود. (توجه کنید که میتوانید آی پی آدرس دستگاه را با مراجعه به منوی *Status - > Overview* در رابط کاربری وب پیدا کنید.) سپس فایل را در همان پوشه ای که BOS Toolbox هست ذخیره کنید و پسوند فایل را از ".txt" به ".csv" تغییر نام دهید.
  * عبارت *FILE_PATH_TO_BOS_TOOLBOX* را در دستور زیر با مسیری که فایل BOS Toolbox را ذخیره کرده‌اید تغییر دهید. سپس با دستور زیر به فایل بروید: ::

::

        cd FILE_PATH_TO_BOS_TOOLBOX

  * اکنون *listOfMiners.csv* را با نام فایل خود در دستور زیر جایگزین کنید و دستور مناسب را برای سیستم عامل خود اجرا کنید:

    برای خط فرمان **Windows**: ::

      bos-toolbox.exe config ARGUMENTS ACTION TABLE

    برای خط فرمان **Linux**: ::
      
      ./bos-toolbox config ARGUMENTS ACTION TABLE

    **توجه** *زمانی که از BOS Toolbox برای لینوکس استفاده می‌کنید، لازم است برای قابل اجرا کردن کردن فایل از دستور زیر استفاده کنید (این برای یکبار کافی‌ است):* ::
  
      chmod u+x ./bos-toolbox

برای تنظیم فرآیند می توانید از **ARGUMENTS** زیر استفاده کنید:

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
-h, --help                             پیغام help نشان داده شود و سپس خارج می‌شود
-u USER, --user USER                  نام کاربری مدیریتی
-p PASSWORD, --password PASSWORD      کلمه عبور مدیریتی یا اینکه پرسیده میشود
-c, --check                           Dry run sans writes
-i, --ignore                          در مواجه با خطا چشم‌پوشی کند
====================================  ============================================================

شما باید **تنها یکی از** **عملیات** زیر را بکار گیرید:

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
load                                  بارگیری تنظیمات حال حاضر ماینر (دستگاهی که در فایل csv 
                                      مشخص شده) و وارد کردن آن به فایل csv
save                                  ذخیره تنظیمات از فایل csv در ماینرها
                                      (آنها را اعمال نمیکند)
apply                                 اعمال تنظیماتی که از فایل csv روی ماینرها ذخیره 
                                      کرده بود
save_apply                            ذخیره و اعمال تنظیمات از فایل csv روی ماینرها
====================================  ============================================================

**مثال:**

::

  ./bos-toolbox.exe multiconfiger --user root load listOfMiners.csv
  
  #فایل CSV را ویرایش کنید (برای مثال با نرم افزارهای Office Excel, LibreOffice Calc و غیره)
  
  ./bos-toolbox.exe multiconfiger --user root save_apply listOfMiners.csv

اولین دستور تنظیمات را از ماینرهایی که در فایل *listOfMiners.csv* لیست شده است بارگیری خواهد کرد. (با استفاده از نام کاربری *root* و در فایل CSV ذخیره خواهد کرد.) شما اکنون میتوانید فایل را باز و ویرایش‌های دلخواه خود را انجام دهید. بعد از ویرایش، دستور دوم تنظیمات را به ماینرها بازخواهد گرداند و در آنها اعمال خواهد کرد. 

.. _bosbox_scan:

==========================================================
اسکن شبکه برای شناسایی ماینرها با استفاده از BOS Toolbox
==========================================================

  * **BOS Toolbox** را از `وبسایت <https://braiins-os.com/>`_. دانلود کنید.
  * یک فایل text جدید ایجاد کنید ، انتهای ".txt" را به ".csv" تغییر دهید و آدرس های IP را که می خواهید دستورات را روی آنها اجرا کنید ، وارد کنید. فایل را در دایرکتوری که BOS Toolbox در آن قرار دارد قرار دهید.
  * پس از دانلود BOS Toolbox، مترجم خط فرمان خود را باز کنید (مانند CMD برای ویندوز ، Terminal برای اوبونتو و غیره) و از دستورات زیر استفاده کنید:
  * یک فایل جدید text در ویرایشگر متنی خود ایجاد کنید و آدرس‌های IP که میخواهید دستورات در آنها اجرا شود را وارد کنید. هر IP باید با کاما از هم جدا شود. (توجه کنید که میتوانید آی پی آدرس دستگاه را با مراجعه به منوی *Status - > Overview* در رابط کاربری وب پیدا کنید.) سپس فایل را در همان پوشه ای که BOS Toolbox هست ذخیره کنید و پسوند فایل را از ".txt" به ".csv" تغییر نام دهید.
  * عبارت *FILE_PATH_TO_BOS_TOOLBOX* را در دستور زیر با مسیری که فایل BOS Toolbox را ذخیره کرده‌اید تغییر دهید. سپس با دستور زیر به فایل بروید: ::

::

        cd FILE_PATH_TO_BOS_TOOLBOX

  * اکنون *listOfMiners.csv* را با نام فایل خود در دستور زیر جایگزین کنید و دستور مناسب را برای سیستم عامل خود اجرا کنید:

    برای خط فرمان **Windows**: ::

      bos-toolbox.exe discover ARGUMENTS

    برای خط فرمان **Linux**: ::
      
     ./bos-toolbox discover ARGUMENTS

    **توجه** *زمانی که از BOS Toolbox برای لینوکس استفاده می‌کنید، لازم است برای قابل اجرا کردن کردن فایل از دستور زیر استفاده کنید (این برای یکبار کافی‌ است):* ::
  
      chmod u+x ./bos-toolbox

You can use the following **arguments** to adjust the process:

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
-h, --help                             پیغام help نشان داده شود و سپس خارج می‌شود
====================================  ============================================================

شما باید **تنها یکی از** **arguments** زیر را بکار گیرید:

====================================  ============================================================
Arguments                             Description
====================================  ============================================================
scan                                  به صورت فعال محدوده آدرسهای مشخص شده را اسکن میکند
listen                                گوش فرا دادن به پخش‌های ارسال دستگاه
                                      (مانند زمانی که دکمه IP Reporter را فشار میدهید)
====================================  ============================================================

**مثال:**

::

  ./bos-toolbox.exe discover scan 10.10.10.0/24

این دستور شبکه را در محدوده آی پی 10.10.10.0 - 10.10.10.255 اسکن و سپس آدرس IP آنها را لیست خواهد کرد. 

.. _web_package:

*******************
بسته Web Package
*******************

بسته مبتنی بر وب می تواند برای جابجایی از فریم ویر اصلی کارخانه ، که قبل از سال 2019 منتشر شد ، مورد استفاده قرار گیرد. همچنین باید روی سایر فریم ویر های اصلی کارخانه کار کند. این بسته نمی تواند برای فیرم ویرهایی استفاده شود که در سال 2019 و بعداً به دلیل تأیید امضای تعبیه شده در دستگاه انتشار یافت. تأیید امضا، از استفاده فریم ویر های غیر از فریم ویر اصلی جلوگیری می کند.

===========
روش کاربرد
===========

  * بسته **Web Package** را از `وبسایت <https://braiins-os.com/>`_ دانلود کنید.
  * بخش های زیر را دنبال کنید

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

  + فریم‌ور اصلی کارخانه را با Braiins OS بدون ابزار اضافی جایگزین می کند
  + تنظیمات شبکه را انتقال می دهد
  + نشانی اینترنتی استخر ، کاربران و رمزهای عبور را انتقال میدهد

  
  - نمی توان در فریم ویر های کارخانه که در سال ۲۰۱۹ و بعد از آن منتشر شده، استفاده کرد
  - نمی تواند نصب را تنظیم کند (به عنوان مثال ، همیشه تنظیمات شبکه را منتقل می کند)
  - بدون batch-mode(مگر اینکه اسکریپت های خود را بسازید)


.. _web_package_install:

=====================================
نصب Braiins OS با استفاده از بسته Web
=====================================

  * بسته **Web Package** را از وب سایت `website <https://braiins-os.com/>`_. دانلود کنید.
  * وارد ماینر خود شوید و به بخش *System -> Upgrade* بروید.
  * بسته دانلود شده را آپلود کرده و فایل ایمیج را فلش کنید.

.. _sd:

*******************
ایمیج کارت حافظه SD
*******************

اگر فریم ویر کارخانه را اجرا می کنید ، که در سال 2019 و بعد از آن منتشر شد ، تنها راه نصب Braiins OS وارد کردن کارت SD با Braiins OS است که روی آن فلش شده است. در سال 2019 ، اتصال SSH مسدود شد و تأیید امضا در رابط کاربری وب مانع استفاده غیر از فریمور اصلی کارخانه می شود.

==========
روش کاربرد
==========

  **SD card image** را از `وبسایت <https://braiins-os.com/>`_ دانلود کنید.
  * بخش های زیر را دنبال کنید

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

  +  فریم‌ور کارخانه را که SSH آن مسدود شده است با Braiins OS جایگزین می کند
  + از تنظیمات شبکه ذخیره شده در NAND استفاده می کند (این گزینه می تواند خاموش شود ، به بخش *Network settings* از زیر مراجعه کنید)

  - آدرس URL استخرها، کاربران و رمز عبور ها را منتقل نمیکند
  - بدون batch-mode

.. _sd_install:

=============================================
نصب Braiins OS با استفاده از کارت حافظه SD
=============================================

 * ایمیج کارت حافظه SD را از `وبسایت <https://braiins-os.com/>`_ دانلود کنید.
 * فایل دانلود شده را روی کارت حافظه SD فلش کنید. (بطور مثال: با نرم افزار `Etcher <https://etcher.io/>`_) *توجه: کپی ساده فایل روی کارت SD کار نخواهد کرد. کارت SD باید فلش شود!*
 * جامپرها را برای بوت شدن از کارت حافظه SD (بجای حافظه NAND) به صورت زیر تغییر دهید.

  .. |pic1| image:: ../_static/s9-jumpers.png
      :width: 45%
      :alt: S9 Jumpers

  .. |pic2| image:: ../_static/s9-jumpers-board.png
      :width: 45%
      :alt: S9 Jumpers Board

  |pic1|  |pic2|

 * کارت SD را در شیار دستگاه قرار دهید و دستگاه را روشن کنید.
 * بعد از چند لحظه شما باید به رابط کاربری Braiins OS از طریق آدرس IP دستگاه دسترسی داشته باشید.
 * *[اختیاری]:* شما می‌توانید Braiins OS را روی NAND نصب کنید. (بخش مربوطه را ببینید :ref:`sd_nand_install`)

.. _sd_network:

================
تنظیمات شبکه
================
 
 به صورت پیشفرض، تنظیمات شبکه‌ای که روی NAND ذخیره شده در حالت اجرای Braiins OS از کارت SD مورد استفاده قرار میگیرد.
 برای غیرفعالسازی این امکان، مراحل زیر را طی کنید:

  * اولین پارتیشن FAT کارت حافظه SD را Mount کنید
  * فایل uEnv.txt را باز کنید و متن زیر را در فایل بنویسید. (دقت کنید در هر سطر یک دستور باشد)

  ::

    cfg_override=no

غیرفعالسازی استفاده از تنظیمات شبکه قدیمی برای کاربرانی سودمند است که مشکلاتی در زمینه مشاهده ماینر در شبکه دارند. (بطور مثال: آی پی که روی NAND استفاده شده بود خارج از رنج شبکه فعلی است). به این ترتیب DHCP استفاده خواهد شد.

.. _sd_nand_install:

============
NAND نصب در
============

از کارت حافظه SD می توان برای جایگزینی فریم‌ور در NAND با Braiins OS استفاده کرد. این کار می تواند از این روش انجام شود:
  * با استفاده از رابط کاربری وب - بخش *System -> Install current system to device (NAND)*
  * با استفاده از ابزار *miner* ، از طریق SSH - این بخش از راهنما را دنبال کنید :ref:`miner_nand_install`

.. _sd_factory_reset:

===================================================================
بازگشت به تنظیم کارخانه Braiins OS با استفاده از کارت حافظه SD
===================================================================

با دنبال کردن مراحل زیر می توانید تنظیم مجدد و بازگشت به تنظیم کارخانه را انجام دهید:

  * Mount the first FAT partition of the SD card
  * Open the file uEnv.txt and insert the following string (make sure there is only one string per line)

  ::

    factory_reset=yes

.. _ssh_package:

****************************
نصب از راه دور با (SSH)
****************************

با روش *Remote (SSH) install package* شما میتوانید Braiins OS را نصب یا حذف کنید. این روش توصیه نمی‌شود زیرا نیاز به نصب بسته‌های پایتون دارد. به جای آن از BOS Toolbox استفاده کنید.


==========
روش کاربرد
==========

  * دانلود بسته **Remote (SSH) install package** از `وبسایت <https://braiins-os.com/>`_.
  * بخش های زیر را دنبال کنید

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

  + Braiins OS را از راه دور نصب می کند
  + Braiins OS را از راه دور پاک می کند
  + هنگام نصب Braiins OS ، کل تنظیمات را بطور پیش فرض (می توان تنظیم کرد) منتقل می کند
  + هنگام حذف Braiins OS، تنظیمات شبکه را بطور پیش فرض (می توان تنظیم کرد) منتقل می کند
  + پارامترها برای سفارشی کردن فرآیند در دسترس هستند

  
 - بدون batch-mode(مگر اینکه اسکریپت های خود را بسازید)
  - نیاز به راه اندازی طولانی دارد
  - درماینری که SSH آن مسدود شده است کار نمی کند

.. _ssh_package_environment:

=========================
آماده سازی محیط
=========================

ابتدا باید محیط پایتون را آماده کنید که شامل مراحل زیر است:

* * (فقط ویندوز) *Ubuntu for Windows 10* از فروشگاه مایکروسافت `در اینجا. <https://www.microsoft.com/en-us/store/p/ubuntu/9nblggh4msv6> `_ نصب کنید

* دستورات زیر را در ترمینال خط فرمان خود اجرا کنید:

*(توجه داشته باشید که دستورات برای ویندوز 10 با اوبونتو و اوبونتو سازگار است. اگر از توزیع دیگری از لینوکس یا سیستم عامل متفاوتی استفاده می کنید ، لطفا مستندات مربوطه را بررسی کرده و در صورت لزوم دستورات را ویرایش کنید.)*

::

  #مخازن را بروز رسانی کرده و پیش نیازها را نصب کنید  
  sudo apt update && sudo apt install python3 python3-virtualenv virtualenv
  
  #بسته فریم‌ور را دانلود و از حالت فشرده خارج کنید
  wget -c https://feeds.braiins-os.org/20.04/braiins-os_am1-s9_ssh_2020-04-30-0-259943b5.tar.gz -O - | tar -xz
  
  #مسیر دایرکتوری را به مسیر بسته غیرفشرده شده تغییر دهید
  cd ./braiins-os_am1-s9_ssh_2020-04-30-0-259943b5
  
  #یک virtual environment ایجاد و آن را فعال سازی کنید
  virtualenv --python=/usr/bin/python3 .env && source .env/bin/activate
  
  #بسته های مورد نیاز پایتون را نصب کنید
  python3 -m pip install -r requirements.txt

.. _ssh_package_install:

=====================================
نصب Braiins OS با استفاده از بسته SSH
=====================================

نصب Braiins OS با استفاده از روش به اصطلاح *SSH Method* شامل مراحل زیر است:

* *(Custom Firmware)* فریم‌ویر اصلی کارخانه را فلش کنید. اگر دستگاه با فریم ویر اصلی کارخانه  یا نسخه های قبلی Braiins OS کار کند ، می توانید از این مرحله صرفنظر کنید. * (توجه: ممکن است که Braiins OS مستقیماً بر روی یک سیستم عامل سفارشی نصب شود ، اما از آنجا که با نسخه اصلی کارخانه تفاوت دارند ، ممکن است لازم باشد ابتدا فریم‌ ویر اصلی را فلش کنید.)*

* * (فقط ویندوز) *Ubuntu for Windows 10* را از فروشگاه مایکروسافت `در اینجا نصب کنید <https://www.microsoft.com/en-us/store/p/ubuntu/9nblggh4msv6> `_
* محیط پایتون را آماده کنید ، که در این بخش توضیح داده شده است :ref:`ssh_package_environment`.
* دستورات زیر را در ترمینال خط فرمان خود اجرا کنید (بر این اساس  ``IP_ADDRESS`` را جایگزین کنید):


*(توجه داشته باشید که دستورات برای ویندوز 10 با اوبونتو و اوبونتو سازگار است. اگر از توزیع دیگری از لینوکس یا سیستم عامل متفاوتی استفاده می کنید ، لطفا مستندات مربوطه را بررسی کرده و در صورت لزوم دستورات را ویرایش کنید.)*

::

  #مسیر دایرکتوری را به مسیر بسته غیرفشرده شده تغییر دهید (اگر در حال حاضر در آن نیست)
  cd ./braiins-os_am1-s9_ssh_2019-02-21-0-572dd48c_2020-03-29-1-6b4a0f46
  
  #فعال سازی virtual environment (درصورتیکه فعال نیست)
  source .env/bin/activate
  
  #اسکریپت را اجرا کنید تا Braiins OS نصب شود
  python3 upgrade2bos.py IP_ADDRESS

.. _ssh_package_uninstall:

=======================================
حذف نصب Braiins OS از طریق بستهSSH
=======================================

.. _ssh_package_uninstall_image:

استفاده از فریم‌ور کارخانه
=============================

ابتدا ، شما باید محیط پایتون را آماده کنید ، که در این بخش توضیح داده شده است :ref:`ssh_package_environment`.


در Antminer S9 ، می توانید ایمیج فریمور کارخانه را از وب سایت سازنده، با مسیر فایل "FACTORY_IMAGE"  
یا URL ``tar.gz`` (اکسترکت نشده!). ایمیج های پشتیبانی شده با هش MD5 مربوطه لیست شده است در فایل `platform.py <https://github.com/braiins/braiins/blob/master/braiins-os/upgrade/am1/platform.py>`__

 دستور زیر را اجرا کنید (``FACTORY_IMAGE`` و ``IP_ADDRESS`` را متناسب با مقادر خود تغییر دهید)

::

  cd ~/braiins-os_am1-s9_ssh_2019-02-21-0-572dd48c_2020-03-29-1-6b4a0f46 && source .env/bin/activate
  python3 restore2factory.py --factory-image FACTORY_IMAGE IP_ADDRESS

.. _ssh_package_uninstall_backup:

استفاده از نسخه پشتیبانی که قبلا تهیه شده است
===============================================

ابتدا ، شما باید محیط پایتون را آماده کنید ، که در این بخش توضیح داده شده است :ref:`ssh_package_environment`.


If you created a backup of the original firmware during the installation of Braiins OS, you can restore it by using the following commands (replace the placeholders ``BACKUP_ID_DATE`` and ``IP_ADDRESS`` accordingly):

::

  cd ~/braiins-os_am1-s9_ssh_2019-02-21-0-572dd48c_2020-03-29-1-6b4a0f46 && source .env/bin/activate
  python3 restore2factory.py backup/BACKUP_ID_DATE/ IP_ADDRESS

** توجه: این روش توصیه نمی شود زیرا ایجاد نسخه پشتیبان بسیار دقیق است. نسخه پشتیبان تهیه شده ممکن است خراب باشد و راهی برای بررسی آن وجود ندارد. می توانید به ریسک خودتان استفاده کنید و مطمئن شوید که در صورت عدم موفقیت بازگشت ، می توانید به ماینر دسترسی پیدا کرده و کارت SD را در آن وارد کنید.**

.. _opkg:

****
OPKG
****

دستورات OPKG پس از اتصال به ماینر از طریق SSH قابل استفاده هستند. دستورات OPKG بسیاری وجود دارد ، اما در مورد Braiins OS، شما فقط باید موارد زیر را استفاده کنید:

  * *opkg update* - لیست های بسته را به روز می کند. توصیه می شود قبل از سایر دستورات OPKG از این دستور استفاده کنید.
  * *opkg install PACKAGE_NAME* بسته تعریف شده را نصب کنید. توصیه می شود قبل از نصب بسته ها از *opkg update* برای به روزرسانی لیست های بسته استفاده کنید.
  * *opkg remove PACKAGE_NAME*

از آنجا که تغییر فریم‌ویرمنجر به ریبوت می شود ،
خروجی زیر انتظار می رود:

::

  ...
  Collected errors:
  * opkg_conf_load: Could not lock /var/lock/opkg.lock: Resource temporarily unavailable.
    Saving config files...
    Connection to 10.10.10.1 closed by remote host.
    Connection to 10.10.10.1 closed.

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

  + Braiins OS را از راه دور بروزرسانی می‌کند
  + از سایر نسخه ها از راه دور به Braiins OS تغییر می‌کند
  + از راه دور به نسخه اولیه Braiins OS برمی‌گردد
  + تنظیمات را منتقل می کند و بدون نیاز به تنظیم چیزی (هنگام بروزرسانی یا تغییر به Braiins OS ) به ماینینگ خود ادامه می دهد.
  
  - بدون batch-mode(مگر اینکه اسکریپت های خود را بسازید)

.. _opkg_update:

===========================================
بروزرسانی Braiins OS با استفاده از OPKG 
===========================================

با OPKG می توانید با اتصال به Miner از طریق SSH و استفاده از دستورات زیر ، نصب فعلی Braiins OS را به راحتی بروزرسانی کنید:

::

  opkg update
  opkg install firmware

  #you can also connect to the miner and run the commands at the same time
  ssh root@IP_ADDRESS "opkg update && opkg install firmware"

این امر تنظیمات را منتقل می کند و بدون نیاز به تنظیم چیزی ، به ماینینگ خود ادامه می دهد.

.. _opkg_switch_to_braiinsplus:

================================================================
از نسخه‌های دیگر با استفاده از OPKG به Braiins OS+ تغییر دهید
================================================================

با OPKG می توانید با اتصال به Miner از طریق SSH و استفاده از دستورات زیر به راحتی به Braiins OS+ بروید.

::

  opkg update
  opkg install bos_plus

  #همچنین می توانید به Miner وصل شوید و همزمان دستورات را اجرا کنید
  ssh root@IP_ADDRESS "opkg update && opkg install bos_plus"

این امر تنظیمات را منتقل می کند و بدون نیاز به تنظیم چیزی ، به ماینینگ خود ادامه می دهد.

.. _opkg_factory_reset:

====================================
Braiins OS factory reset using OPKG
====================================

With OPKG you can easily revert to the initial version of Braiins OS (the version, which was installed for the first time on that device), by connecting to the miner via SSH and using the following commands:

::

  opkg update
  opkg remove firmware

  #همچنین می توانید به Miner وصل شوید و همزمان همزمان دستورات را اجرا کنید
  ssh root@IP_ADDRESS "opkg update && opkg remove firmware"

این دستور تنظیمات را به حالت اولین نصب Braiins OS بازنشانی میکند

.. _sysupgrade:

******************
Sysupgrade بسته
******************

‏Sysupgrade برای به روزرسانی سیستم در حال اجرا در دستگاه استفاده می شود. با استفاده از این روش می توانید نسخه های مختلف Braiins OS را نصب کرده یا سیستم پشتیبان تهیه کنید. نصب یک فریم‌ویر از طریق *Braiins OS web interface* یا  از طریق *opkg install firmware* از این روش استفاده می کند. توصیه می شود به جای این روش از *Braiins OS web interface* یا *opkg install firmware* استفاده کنید

==========
روش کاربرد
==========

برای استفاده از sysupgrade ، باید از طریق SSH به Miner متصل شوید. کد دستوری به شکل زیر است:

::

  sysupgrade [parameters] <image file or URL>

مهمترین پارامترها عبارتند از  **--help** (برای نمایش راهنما) و **-F** برای اجبار نصب. استفاده از این روش توصیه نمی شود (علاوه بر این روش ، در ادامه توضیح داده شده است) ، مگر اینکه واقعاً بدانید ، چه کاری انجام می دهید

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

+ در حالی که به ماینر وصل است ، نسخه متفاوتی از Braiins OS را نصب می کند.
  + پیکربندی را انتقال میدهد.
  + پارامترها برای سفارشی کردن فرآیند در دسترس هستند
  
  - بدون حالت batch-mode (مگر اینکه اسکریپت های خود را بسازید)
  - نمی توانید به نسخه قدیمی Braiins OS(که قبل از سال 2020 منتشر شد) تغییر دهید

.. _sysupgrade_switch_braiinsos:

==================================================================================================
از نسخه های دیگر با استفاده از Sysupgrade به  Braiins OS (بدون استفاده از اتوتونینگ) تغییر دهید
==================================================================================================

به منظور به روزرسانی از نسخه قدیمی Braiins OS یا بازگردانی از Braiins OS+، از دستور زیر استفاده کنید (به ترتیب ``IP_ADDRESS`` را جایگزین کنید):

::

  ssh root@IP_ADDRESS 'wget -O /tmp/firmware.tar https://feeds.braiins-os.org/am1-s9/firmware_2020-04-30-0-259943b5_arm_cortex-a9_neon.tar && sysupgrade /tmp/firmware.tar'

این دستور شامل دستورات زیر میباشد: 

  * **ssh** - برای ارتباط با ماینر
  * **wget** - برای دانلود فایلها‌، برای مثال دانلود بسته‌های فریم‌ور 
  * **sysupgrade** - برای فلش کردن بسته‌های دانلود شده

.. _sysupgrade_switch_braiinsplus:

======================================================================
از نسخه های دیگر با استفاده از Sysupgrade به Braiins OS+ تغییر دهید
======================================================================

برای به روزرسانی از نسخه قدیمی Braiins OS، از دستور زیر استفاده کنید (به ترتیب ``IP_ADDRESS`` را جایگزین کنید):

::

  ssh root@IP_ADDRESS 'wget -O /tmp/firmware.tar http://feeds.braiins-os.com/am1-s9/firmware_2020-04-30-1-cbf99510-plus_arm_cortex-a9_neon.tar && sysupgrade /tmp/firmware.tar'

این دستور شامل دستورات زیر میباشد: 

  * **ssh** - برای ارتباط با ماینر
  * **wget** - برای دانلود فایلها‌، برای مثال دانلود بسته‌های فریم‌ور 
  * **sysupgrade** - برای فلش کردن بسته‌های دانلود شده

توجه: توصیه می شود به جای این روش از گزینه *BOS Toolbox*, *Braiins OS web interface* یا *opkg install bos_plus* استفاده کنید.

.. _bos2bos:

****************
اسکریپت Bos2Bos
****************

**اسکریپت Bos2Bos برای استفاده توصیه نمی شود ، مگر اینکه با استفاده از روش های دیگر در نصب به مشکل برخورد کنید. **  این روش تنها در صورتی کار می کند که Braiins OS قبلاً روی دستگاه باشد

=======================================
ویژگی ها، مزایا و معایب این روش:
=======================================

  + هر نسخه از Braiins OS را از راه دور نصب می کند
  + یک نسخه تمیز ازBraiins OS نصب کنید
  + پارامترها برای سفارشی کردن فرآیند در دسترس هستند
  
  - بدون حالت batch-mode (مگر اینکه اسکریپت های خود را بسازید)

=======
کاربرد
=======

استفاده از اسکریپت Bos2Bos به تنظیمات زیر نیاز دارد:

* *(فقط Windows)* برای نصب *Ubuntu for Windows 10* به فروشگاه نرم‌افزار مایکروسافت مراجعه کنید `اینجا. <https://www.microsoft.com/en-us/store/p/ubuntu/9nblggh4msv6>`_
* استفاده از اسکریپت Bos2Bos به تنظیمات زیر نیاز دارد:

*(توجه داشته باشید که این دستورات برای Ubuntu و ویندوز 10 برای Ubuntu سازگار است. اگر از توزیع مختلف لینوکس یا سیستم عامل دیگری استفاده می کنید ، لطفا مستندات مربوطه را بررسی کرده و در صورت لزوم دستورات را ویرایش کنید.)*

::
  
  #بروز رسانی مخازن و نصب پیش‌نیازها
  sudo apt update && sudo apt install python3 python3-virtualenv virtualenv
  
  # تکثیر مخرن
  git clone https://github.com/braiins/braiins-os.git
  
  #تغییر پوشه
  cd ./braiins-os/braiins-os/

  #ایجاد یک virtual environment و فعال سازی آن
  virtualenv --python=/usr/bin/python3 .env && source .env/bin/activate
  
  #نصب بسته‌های لازم پایتون
  python3 -m pip install -r requirements.txt

پس از اینکه با موفقیت نصب را به پایان رساندید، میتوانید از دستور زیر استفاده کنید:

::

  #فعال سازی virtual environment
  source .env/bin/activate

  #کاربرد پایه به صورت زیر است
  python3 bos2bos.py FIRMWARE_URL IP_ADDRESS

  #توضیحات تمام پارامترهای موجود با استفاده از دستور زیر قابل مشاهده است
  python3 bos2bos.py -h

************
Miner  ابزار
************

.. _miner_nand_install:

===========================================
نصب از کارت SD به NAND از طریق ابزار Miner
===========================================

از کارت SD می توان برای جایگزینی فریم‌ویر در NAND با Braiins OS استفاده کرد. این کار با اتصال به Miner از طریق SSH و استفاده از دستور زیر قابل انجام است


  ::

    miner nand_install


.. _miner_factory_reset:

==================================================================
تنظیم مجدد به نسخه کارخانه Braiins OS با استفاده از ابزار Miner
==================================================================

تنظیم مجدد به نسخه کارخانه همچنین می تواند با استفاده از ابزار *Miner tool* انجام شود. برای انجام این کار از دستور زیر استفاده کنید:

  ::

    miner nand_install

.. _miner_detect:

================================================
تشخیص دستگاه با استفاده از ابزار ماینر توسط LED
================================================

با استفاده از ابزار *Miner tool* می توانید دستگاه را با روشن کردن چشمک زن LED پیدا کنید. برای انجام این کار از دستور زیر استفاده کنید:

  ::

    #turn on LED blinking
    miner fault_light on

    #turn off LED blinking
    miner fault_light off
